<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://jeromeboyer.net/ML-studies/data/features/ rel=canonical><link href=../ rel=prev><link href=../../ml/ rel=next><link rel=icon href=../../assets/logo.drawio.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Feature Engineering - Machine Learning Studies - Jerome Boyer</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#feature-engineering class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Machine Learning Studies - Jerome Boyer" class="md-header__button md-logo" aria-label="Machine Learning Studies - Jerome Boyer" data-md-component=logo> <img src=../../assets/logo.drawio.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Machine Learning Studies - Jerome Boyer </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Feature Engineering </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/ML-studies title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class="md-tabs__item md-tabs__item--active"> <a href=../.. class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../ml/ class=md-tabs__link> Machine Learning </a> </li> <li class=md-tabs__item> <a href=../../ml/deep-learning/ class=md-tabs__link> Deep Learning </a> </li> <li class=md-tabs__item> <a href=../../genAI/ class=md-tabs__link> Generative AI </a> </li> <li class=md-tabs__item> <a href=../../techno/airflow/ class=md-tabs__link> Techno </a> </li> <li class=md-tabs__item> <a href=../../coding/ class=md-tabs__link> Coding </a> </li> <li class=md-tabs__item> <a href=../../solutions/ class=md-tabs__link> Solutions </a> </li> <li class=md-tabs__item> <a href=https://jbcodeforce.github.io class=md-tabs__link> Home </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Machine Learning Studies - Jerome Boyer" class="md-nav__button md-logo" aria-label="Machine Learning Studies - Jerome Boyer" data-md-component=logo> <img src=../../assets/logo.drawio.png alt=logo> </a> Machine Learning Studies - Jerome Boyer </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/ML-studies title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../guide_for_ai/ class=md-nav__link> <span class=md-ellipsis> Guide for AI/ML </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_3> <label class=md-nav__link for=__nav_1_3 id=__nav_1_3_label tabindex=0> <span class=md-ellipsis> Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../concepts/ class=md-nav__link> <span class=md-ellipsis> Core concepts </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/maths/ class=md-nav__link> <span class=md-ellipsis> Math summary </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/skill/ class=md-nav__link> <span class=md-ellipsis> Data scientist skill </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_4> <label class=md-nav__link for=__nav_1_4 id=__nav_1_4_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/sol-design/ class=md-nav__link> <span class=md-ellipsis> Solution Design </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_5 checked> <label class=md-nav__link for=__nav_1_5 id=__nav_1_5_label tabindex=0> <span class=md-ellipsis> Data management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_5_label aria-expanded=true> <label class=md-nav__title for=__nav_1_5> <span class="md-nav__icon md-icon"></span> Data management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Feature Engineering </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Feature Engineering </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#goals class=md-nav__link> <span class=md-ellipsis> Goals </span> </a> </li> <li class=md-nav__item> <a href=#some-technics class=md-nav__link> <span class=md-ellipsis> Some technics </span> </a> <nav class=md-nav aria-label="Some technics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#missing-values class=md-nav__link> <span class=md-ellipsis> Missing values </span> </a> </li> <li class=md-nav__item> <a href=#categorical-variables class=md-nav__link> <span class=md-ellipsis> Categorical variables </span> </a> </li> <li class=md-nav__item> <a href=#mutual-information class=md-nav__link> <span class=md-ellipsis> Mutual information </span> </a> </li> <li class=md-nav__item> <a href=#discovering-new-features class=md-nav__link> <span class=md-ellipsis> Discovering new features </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Machine Learning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ml/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../ml/classifier/ class=md-nav__link> <span class=md-ellipsis> Classifier </span> </a> </li> <li class=md-nav__item> <a href=../../ml/unsupervised/ class=md-nav__link> <span class=md-ellipsis> Unsupervised Learning </span> </a> </li> <li class=md-nav__item> <a href=../../anomaly/ class=md-nav__link> <span class=md-ellipsis> Anomaly detection </span> </a> </li> <li class=md-nav__item> <a href=../../neuro-symbolic/ class=md-nav__link> <span class=md-ellipsis> Hybrid AI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Deep Learning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Deep Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ml/deep-learning/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../ml/nlp/ class=md-nav__link> <span class=md-ellipsis> NLP </span> </a> </li> <li class=md-nav__item> <a href=../../coding/ddp/ class=md-nav__link> <span class=md-ellipsis> Distributed Data Parallel </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Generative AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Generative AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../genAI/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/review/ class=md-nav__link> <span class=md-ellipsis> Skill set </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/prompt-eng/ class=md-nav__link> <span class=md-ellipsis> Prompt Engineering </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/sol-design/ class=md-nav__link> <span class=md-ellipsis> Solution Design </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/rag/ class=md-nav__link> <span class=md-ellipsis> RAG </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/agentic/ class=md-nav__link> <span class=md-ellipsis> Agentic AI </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/anthropic/ class=md-nav__link> <span class=md-ellipsis> Anthropic </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/openai/ class=md-nav__link> <span class=md-ellipsis> OpenAI </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/mcp/ class=md-nav__link> <span class=md-ellipsis> MCP </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/mistral/ class=md-nav__link> <span class=md-ellipsis> Mistral </span> </a> </li> <li class=md-nav__item> <a href=../../genAI/cohere/ class=md-nav__link> <span class=md-ellipsis> Cohere </span> </a> </li> <li class=md-nav__item> <a href=../../techno/watsonx/ class=md-nav__link> <span class=md-ellipsis> WatsonX.ai </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Techno </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Techno </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/airflow/ class=md-nav__link> <span class=md-ellipsis> Airflow </span> </a> </li> <li class=md-nav__item> <a href=../../techno/feature_store/ class=md-nav__link> <span class=md-ellipsis> Feature Store </span> </a> </li> <li class=md-nav__item> <a href=../../kaggle/ class=md-nav__link> <span class=md-ellipsis> Kaggle </span> </a> </li> <li class=md-nav__item> <a href=../../techno/opensearch/ class=md-nav__link> <span class=md-ellipsis> OpenSearch </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/python-code/ class=md-nav__link> <span class=md-ellipsis> Python studies </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/yarfba/ai-ml/sagemaker class=md-nav__link> <span class=md-ellipsis> SageMaker </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/spark-studies/ class=md-nav__link> <span class=md-ellipsis> Spark studies </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_8> <label class=md-nav__link for=__nav_5_8 id=__nav_5_8_label tabindex=0> <span class=md-ellipsis> UI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_8_label aria-expanded=false> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> UI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/gradio/ class=md-nav__link> <span class=md-ellipsis> Gradio </span> </a> </li> <li class=md-nav__item> <a href=../../techno/streamlit/ class=md-nav__link> <span class=md-ellipsis> Streamlit </span> </a> </li> <li class=md-nav__item> <a href=../../techno/taipy/ class=md-nav__link> <span class=md-ellipsis> TaiPy </span> </a> </li> <li class=md-nav__item> <a href=../../techno/nicegui/ class=md-nav__link> <span class=md-ellipsis> NiceGUI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../techno/gcp/ class=md-nav__link> <span class=md-ellipsis> GCP </span> </a> </li> <li class=md-nav__item> <a href=../../techno/watsonx/ class=md-nav__link> <span class=md-ellipsis> WatsonX.ai </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../coding/ class=md-nav__link> <span class=md-ellipsis> Coding getting started </span> </a> </li> <li class=md-nav__item> <a href=../../coding/visualization/ class=md-nav__link> <span class=md-ellipsis> Data Visualization </span> </a> </li> <li class=md-nav__item> <a href=../../coding/haystack/ class=md-nav__link> <span class=md-ellipsis> Haystack.ai </span> </a> </li> <li class=md-nav__item> <a href=../../coding/langchain/ class=md-nav__link> <span class=md-ellipsis> LangChain </span> </a> </li> <li class=md-nav__item> <a href=../../coding/langgraph/ class=md-nav__link> <span class=md-ellipsis> LangGraph </span> </a> </li> <li class=md-nav__item> <a href=../../coding/llama-index/ class=md-nav__link> <span class=md-ellipsis> LlamaIndex </span> </a> </li> <li class=md-nav__item> <a href=../../coding/pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas </span> </a> </li> <li class=md-nav__item> <a href=../../coding/pytorch/ class=md-nav__link> <span class=md-ellipsis> PyTorch </span> </a> </li> <li class=md-nav__item> <a href=../../coding/sklearn/ class=md-nav__link> <span class=md-ellipsis> Scikit-learn </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Solutions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Solutions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../solutions/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../techno/players_to_look/ class=md-nav__link> <span class=md-ellipsis> Key AI startups </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#goals class=md-nav__link> <span class=md-ellipsis> Goals </span> </a> </li> <li class=md-nav__item> <a href=#some-technics class=md-nav__link> <span class=md-ellipsis> Some technics </span> </a> <nav class=md-nav aria-label="Some technics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#missing-values class=md-nav__link> <span class=md-ellipsis> Missing values </span> </a> </li> <li class=md-nav__item> <a href=#categorical-variables class=md-nav__link> <span class=md-ellipsis> Categorical variables </span> </a> </li> <li class=md-nav__item> <a href=#mutual-information class=md-nav__link> <span class=md-ellipsis> Mutual information </span> </a> </li> <li class=md-nav__item> <a href=#discovering-new-features class=md-nav__link> <span class=md-ellipsis> Discovering new features </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=feature-engineering>Feature Engineering<a class=headerlink href=#feature-engineering title="Permanent link">&para;</a></h1> <h2 id=goals>Goals<a class=headerlink href=#goals title="Permanent link">&para;</a></h2> <p>The goal of feature engineering is to make the data better suited to the problem at hand. <strong>Features</strong> are the measurable data points that a model uses to predict an outcome.</p> <p>We might perform feature engineering to:</p> <ul> <li>Improve a model's predictive performance.</li> <li>Reduce computational or data needs.</li> <li>Improve interpretability of the results.</li> </ul> <p>For a feature to be useful, it must have a relationship to the target that our model is able to learn. Linear models, for instance, are only able to learn linear relationships. When using a linear model, our goal is to transform the features to make their relationship to the target, linear.</p> <p>See <a href=https://www.kaggle.com/sinamhd9/concrete-comprehensive-strength>the Kaggle's concrete compressive strength example</a> with some related notebooks on feature engineering.</p> <p>Feature engineering includes tasks like:</p> <ul> <li>Locating features with the most potential.</li> <li>Creating new features.</li> <li>Assessing potential clusters to discover complex spatial relationship.</li> <li>Analyzing variations to discover new features.</li> <li>Defining encoding.</li> </ul> <h2 id=some-technics>Some technics<a class=headerlink href=#some-technics title="Permanent link">&para;</a></h2> <h3 id=missing-values>Missing values<a class=headerlink href=#missing-values title="Permanent link">&para;</a></h3> <p>Remove rows with missing target:</p> <div class=highlight><pre><span></span><code><span class=n>X_full</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;SalePrice&#39;</span><span class=p>],</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=c1># To keep things simple, we&#39;ll use only numerical predictors</span>
<span class=n>X</span> <span class=o>=</span> <span class=n>X_full</span><span class=o>.</span><span class=n>select_dtypes</span><span class=p>(</span><span class=n>exclude</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;object&#39;</span><span class=p>])</span>
</code></pre></div> <p>Assess number of missing values in each column. Pandas offers capabilities to easily assess missing cell in a matrix: </p> <div class=highlight><pre><span></span><code><span class=n>missing_val_count_by_column</span> <span class=o>=</span> <span class=p>(</span><span class=n>X_train</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
<span class=nb>print</span><span class=p>(</span><span class=n>missing_val_count_by_column</span><span class=p>[</span><span class=n>missing_val_count_by_column</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>])</span>
</code></pre></div> <p>Avoid dropping a column when there are some missing values, except if the column has a lot of them, and it does not seem to bring much more impact to the result.</p> <div class=highlight><pre><span></span><code><span class=c1># Get names of columns with missing values</span>
<span class=n>cols_with_missing</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>X_train</span><span class=o>.</span><span class=n>columns</span>
                     <span class=k>if</span> <span class=n>X_train</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>any</span><span class=p>()]</span>

<span class=c1># Drop columns in training and validation data</span>
<span class=n>reduced_X_train</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>cols_with_missing</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>reduced_X_valid</span> <span class=o>=</span> <span class=n>X_valid</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>cols_with_missing</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <p>We can use different interpolation techniques to estimate the missing values from the training samples. One of the most common interpolation techniques is mean imputation, where we simply replace the missing value by the mean value of the entire feature column. This is done by using the sklearn `Imputer`` class.</p> <p>The Imputer class belongs to the so-called transformer classes in scikit-learn that are used for data transformation. The two essential methods of those estimators are fit and transform. The fit method is used to learn the parameters from the training data, and the transform method uses those parameters to transform the data. Any data array that is to be transformed needs to have the same number of features as the data array that was used to fit the model.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<span class=n>my_imputer</span> <span class=o>=</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)</span>
<span class=n>imputed_X_train</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>my_imputer</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>))</span>
<span class=n>imputed_X_valid</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>my_imputer</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_valid</span><span class=p>))</span>

<span class=c1># Imputation removed column names; put them back</span>
<span class=n>imputed_X_train</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>columns</span>
<span class=n>imputed_X_valid</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=n>X_valid</span><span class=o>.</span><span class=n>columns</span>
</code></pre></div> <p>We can add a boolean column which will have cell set to true when a mean was assigned to a missing value. In some cases, this will meaningfully improve results.</p> <div class=highlight><pre><span></span><code><span class=n>cols_with_missing</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>X_train</span><span class=o>.</span><span class=n>columns</span>
                     <span class=k>if</span> <span class=n>X_train</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>any</span><span class=p>()]</span>
<span class=c1># Make copy to avoid changing original data (when imputing)</span>
<span class=n>X_train_plus</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>X_valid_plus</span> <span class=o>=</span> <span class=n>X_valid</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

<span class=c1># Make new boolean columns indicating what will be imputed</span>
<span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>cols_with_missing</span><span class=p>:</span>
    <span class=n>X_train_plus</span><span class=p>[</span><span class=n>col</span> <span class=o>+</span> <span class=s1>&#39;_was_missing&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X_train_plus</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span>
    <span class=n>X_valid_plus</span><span class=p>[</span><span class=n>col</span> <span class=o>+</span> <span class=s1>&#39;_was_missing&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X_valid_plus</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span>

<span class=c1># Imputation</span>
<span class=n>my_imputer</span> <span class=o>=</span> <span class=n>SimpleImputer</span><span class=p>()</span>
<span class=n>imputed_X_train_plus</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>my_imputer</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train_plus</span><span class=p>))</span>
<span class=n>imputed_X_valid_plus</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>my_imputer</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_valid_plus</span><span class=p>))</span>
</code></pre></div> <h3 id=categorical-variables>Categorical variables<a class=headerlink href=#categorical-variables title="Permanent link">&para;</a></h3> <p>A categorical variable takes only a limited number of values. We need to preprocess them to numerical values.</p> <div class=highlight><pre><span></span><code><span class=c1># Get list of categorical variables</span>
<span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=n>X_train</span><span class=o>.</span><span class=n>dtypes</span> <span class=o>==</span> <span class=s1>&#39;object&#39;</span><span class=p>)</span>
<span class=n>object_cols</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>s</span><span class=p>]</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
<span class=c1># drop categorial variable columns</span>
<span class=n>drop_X_train</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>select_dtypes</span><span class=p>(</span><span class=n>exclude</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;object&#39;</span><span class=p>])</span>
<span class=n>drop_X_valid</span> <span class=o>=</span> <span class=n>X_valid</span><span class=o>.</span><span class=n>select_dtypes</span><span class=p>(</span><span class=n>exclude</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;object&#39;</span><span class=p>])</span>
</code></pre></div> <p><strong>Ordinal encoding</strong> assigns each unique value to a different integer.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>OrdinalEncoder</span>
<span class=n>ordinal_encoder</span> <span class=o>=</span> <span class=n>OrdinalEncoder</span><span class=p>()</span>
<span class=n>label_X_train</span><span class=p>[</span><span class=n>object_cols</span><span class=p>]</span> <span class=o>=</span> <span class=n>ordinal_encoder</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>[</span><span class=n>object_cols</span><span class=p>])</span>
<span class=n>label_X_valid</span><span class=p>[</span><span class=n>object_cols</span><span class=p>]</span> <span class=o>=</span> <span class=n>ordinal_encoder</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_valid</span><span class=p>[</span><span class=n>object_cols</span><span class=p>])</span>
</code></pre></div> <p>When there are some categorical value in test set that are not in the training set, then a solution is to write a custom ordinal encoder to deal with new categories, or drop the column.</p> <div class=highlight><pre><span></span><code><span class=c1># first get all categorical columns</span>
<span class=n>object_cols</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>X_train</span><span class=o>.</span><span class=n>columns</span> <span class=k>if</span> <span class=n>X_train</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>dtype</span> <span class=o>==</span> <span class=s2>&quot;object&quot;</span><span class=p>]</span>

<span class=c1># Columns that can be safely ordinal encoded</span>
<span class=n>good_label_cols</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>object_cols</span> <span class=k>if</span> 
                   <span class=nb>set</span><span class=p>(</span><span class=n>X_valid</span><span class=p>[</span><span class=n>col</span><span class=p>])</span><span class=o>.</span><span class=n>issubset</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>X_train</span><span class=p>[</span><span class=n>col</span><span class=p>]))]</span>

<span class=c1># Problematic columns that will be dropped from the dataset</span>
<span class=n>bad_label_cols</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>object_cols</span><span class=p>)</span><span class=o>-</span><span class=nb>set</span><span class=p>(</span><span class=n>good_label_cols</span><span class=p>))</span>
</code></pre></div> <p><strong>One-hot encoding</strong> creates new columns indicating the presence (or absence) of each possible value in the original data. One-hot encoding does not assume an ordering of the categories:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>OneHotEncoder</span>

<span class=c1># Apply one-hot encoder to each column with categorical data</span>
<span class=n>OH_encoder</span> <span class=o>=</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>,</span> <span class=n>sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>OH_cols_train</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>OH_encoder</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>[</span><span class=n>object_cols</span><span class=p>]))</span>
<span class=n>OH_cols_valid</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>OH_encoder</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_valid</span><span class=p>[</span><span class=n>object_cols</span><span class=p>]))</span>

<span class=c1># One-hot encoding removed index; put it back</span>
<span class=n>OH_cols_train</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>index</span>
<span class=n>OH_cols_valid</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>X_valid</span><span class=o>.</span><span class=n>index</span>

<span class=c1># Remove categorical columns (will replace with one-hot encoding)</span>
<span class=n>num_X_train</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>object_cols</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>num_X_valid</span> <span class=o>=</span> <span class=n>X_valid</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>object_cols</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># Add one-hot encoded columns to existing numerical features</span>
<span class=n>OH_X_train</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>num_X_train</span><span class=p>,</span> <span class=n>OH_cols_train</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>OH_X_valid</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>num_X_valid</span><span class=p>,</span> <span class=n>OH_cols_valid</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <p>For large datasets with many rows, one-hot encoding can greatly expand the size of the dataset.<br> For this reason, we typically will only one-hot encode columns with relatively low cardinality. Then, high cardinality columns can either be dropped from the dataset, or we can use ordinal encoding.</p> <div class=highlight><pre><span></span><code><span class=c1># code to get low cardinality</span>
<span class=n>low_cardinality_cols</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>object_cols</span> <span class=k>if</span> <span class=n>X_train</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>nunique</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>]</span>
</code></pre></div> <p>Remarks that Pandas offers built-in features to do encoding</p> <div class=highlight><pre><span></span><code><span class=c1># One-hot encode the data (to shorten the code, we use pandas)</span>
<span class=n>X_train</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
<span class=n>X_valid</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>X_valid</span><span class=p>)</span>
<span class=n>X_test</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<span class=n>X_train</span><span class=p>,</span> <span class=n>X_valid</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>align</span><span class=p>(</span><span class=n>X_valid</span><span class=p>,</span> <span class=n>join</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span> <span class=o>=</span> <span class=n>X_train</span><span class=o>.</span><span class=n>align</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>join</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <h3 id=mutual-information>Mutual information<a class=headerlink href=#mutual-information title="Permanent link">&para;</a></h3> <p>The first step is to construct a ranking with a feature utility metric, a function measuring associations between a feature and the target. Then we can select a smaller set of the most useful features to develop initially. Mutual information is a lot like correlation in that it measures a relationship between two quantities. The advantage of mutual information is that it can detect any kind of relationship, while correlation only detects linear relationships.</p> <p>The least possible mutual information between quantities is 0.0. When MI is zero, the quantities are independent: neither can tell us anything about the other.</p> <p>It's possible for a feature to be very informative when interacting with other features, but not so informative all alone. MI can't detect interactions between features. It is a univariate metric.</p> <p>We may need to transform the feature first to expose the association.</p> <p>The scikit-learn algorithm for MI treats discrete features differently from continuous features. Consequently, we need to tell it which are which. Anything that must have a float dtype is not discrete. Categoricals (object or categorial dtype) can be treated as discrete by giving them a label encoding.</p> <p>See example of mutual information in <a href=https://github.com/jbcodeforce/ml-basics/blob/master/ml-python/kaggle-training/car-price/PredictCarPrice.py>ml-python/kaggle-training/car-price/PredictCarPrice.py</a>.</p> <h3 id=discovering-new-features>Discovering new features<a class=headerlink href=#discovering-new-features title="Permanent link">&para;</a></h3> <ul> <li>Understand the features. Refer to the dataset's data documentation.</li> <li>Research the problem domain to acquire domain knowledge: Research fields a variety of formulas for creating potentially useful new features. </li> <li>Study <a href=https://www.kaggle.com/sudalairajkumar/winning-solutions-of-kaggle-competitions>Kaggle's winning solutions</a></li> <li>Use data visualization. Visualization can reveal pathologies in the distribution of a feature or complicated relationships that could be simplified</li> </ul> <p>The more complicated a combination is, the more difficult it will be for a model to learn.</p> <p>Data visualization can suggest transformations, often a "reshaping" of a feature through powers or logarithms.</p> <p>Features describing the presence or absence of something often come in sets. We can aggregate such features by creating a count. </p> <div class=highlight><pre><span></span><code><span class=c1># creating a feature that describes how many kinds of outdoor areas a dwelling has</span>
<span class=n>X_3</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
<span class=n>X_3</span><span class=p>[</span><span class=s2>&quot;PorchTypes&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span>
    <span class=s2>&quot;WoodDeckSF&quot;</span><span class=p>,</span>
    <span class=s2>&quot;OpenPorchSF&quot;</span><span class=p>,</span>
    <span class=s2>&quot;EnclosedPorch&quot;</span><span class=p>,</span>
    <span class=s2>&quot;Threeseasonporch&quot;</span><span class=p>,</span>
    <span class=s2>&quot;ScreenPorch&quot;</span><span class=p>,</span>
<span class=p>]]</span><span class=o>.</span><span class=n>gt</span><span class=p>(</span><span class=mf>0.0</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <p>Here is an example on how to extract roadway features from the car accidents and compute the number of such roadway in each accident. </p> <div class=highlight><pre><span></span><code><span class=n>roadway_features</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Amenity&quot;</span><span class=p>,</span> <span class=s2>&quot;Bump&quot;</span><span class=p>,</span> <span class=s2>&quot;Crossing&quot;</span><span class=p>,</span> <span class=s2>&quot;GiveWay&quot;</span><span class=p>,</span>
    <span class=s2>&quot;Junction&quot;</span><span class=p>,</span> <span class=s2>&quot;NoExit&quot;</span><span class=p>,</span> <span class=s2>&quot;Railway&quot;</span><span class=p>,</span> <span class=s2>&quot;Roundabout&quot;</span><span class=p>,</span> <span class=s2>&quot;Station&quot;</span><span class=p>,</span> <span class=s2>&quot;Stop&quot;</span><span class=p>,</span>
    <span class=s2>&quot;TrafficCalming&quot;</span><span class=p>,</span> <span class=s2>&quot;TrafficSignal&quot;</span><span class=p>]</span>
<span class=n>accidents</span><span class=p>[</span><span class=s2>&quot;RoadwayFeatures&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>accidents</span><span class=p>[</span><span class=n>roadway_features</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <p>Extract Category from a column with string like: <code>One_Story_1946_and_Newer_All_Styles</code></p> <div class=highlight><pre><span></span><code><span class=n>X_4</span><span class=p>[</span><span class=s1>&#39;MSClass&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>MSSubClass</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=p>,</span><span class=n>n</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span><span class=n>expand</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</code></pre></div> <p><strong>Group transforms</strong> aggregates information across multiple rows grouped by some category. With a group transform we can create features like: </p> <ul> <li>"the average income of a person's state of residence,"</li> <li>"the proportion of movies released on a weekday, by genre."</li> </ul> <p>Using an aggregation function, a group transform combines two features: a categorical feature that provides the grouping and another feature whose values we wish to aggregate. Handy methods include <code>mean, max, min, median, var, std, count</code>.</p> <div class=highlight><pre><span></span><code><span class=n>customer</span><span class=p>[</span><span class=s2>&quot;AverageIncome&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>customer</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>&quot;State&quot;</span><span class=p>)</span>  <span class=c1># for each state</span>
    <span class=p>[</span><span class=s2>&quot;Income&quot;</span><span class=p>]</span>                 <span class=c1># select the income</span>
    <span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s2>&quot;mean&quot;</span><span class=p>)</span>         <span class=c1># and compute its mean</span>
<span class=p>)</span>
</code></pre></div> <p>If we're using training and validation splits, to preserve their independence, it's best to create a grouped feature using only the training set and then join it to the validation set. </p> <div class=highlight><pre><span></span><code><span class=c1># Create splits</span>
<span class=n>df_train</span> <span class=o>=</span> <span class=n>customer</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>frac</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
<span class=n>df_valid</span> <span class=o>=</span> <span class=n>customer</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>df_train</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>

<span class=c1># Create the average claim amount by coverage type, on the training set</span>
<span class=n>df_train</span><span class=p>[</span><span class=s2>&quot;AverageClaim&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_train</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>&quot;Coverage&quot;</span><span class=p>)[</span><span class=s2>&quot;ClaimAmount&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s2>&quot;mean&quot;</span><span class=p>)</span>

<span class=c1># Merge the values into the validation set</span>
<span class=n>df_valid</span> <span class=o>=</span> <span class=n>df_valid</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>df_train</span><span class=p>[[</span><span class=s2>&quot;Coverage&quot;</span><span class=p>,</span> <span class=s2>&quot;AverageClaim&quot;</span><span class=p>]]</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=p>(),</span>
    <span class=n>on</span><span class=o>=</span><span class=s2>&quot;Coverage&quot;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s2>&quot;left&quot;</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Introduction </div> </div> </a> <a href=../../ml/ class="md-footer__link md-footer__link--next" aria-label="Next: Introduction"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Introduction </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2018 - 2024 Jerome Boyer </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/jbcodeforce target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/jeromeboyer target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "content.code.copy", "search.highlight", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.tracking", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>